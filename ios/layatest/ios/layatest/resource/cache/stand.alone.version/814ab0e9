function NetServer(e){this.socket=null,this.receiveTime=0,this.receiveTimeout=5e3,this.serverIndex=0,Laya.timer.loop(2e3,this,this.checkNet)}function HandCell(e){Laya.Sprite.call(this),this.id=e,this.select=!1,this.flag=!1}function Poker(e){HandCell.call(this,e);var t=new laya.ui.Image;t.skin=SPoker.root+SPoker.cards[e].icon,this.addChild(t),this.icon=t,this.width=t.width,this.height=t.height}function Pokers(e,t){if(Laya.Sprite.call(this),0!=e.length){this.ids=e,this.scale=t,this.scaleX=t,this.scaleY=t;var a=Poker.createCards(e);this.cards=a;for(var i=0;i<a.length;++i){var n=a[i];n.pos(i*SPoker.cardSpace,0),this.addChild(n)}this.width=((e.length-1)*SPoker.cardSpace+SPoker.cardWidth)*t,this.height=SPoker.cardHeight*t}}function Pokers2(e,t){if(Laya.Sprite.call(this),0!=e.length){this.scale=t,this.cards=e,this.scaleX=t,this.scaleY=t;for(var a=0;a<e.length;++a){var i=e[a];i.pos(a*SPoker.cardSpace,0),this.addChild(i)}this.width=((e.length-1)*SPoker.cardSpace+SPoker.cardWidth)*t,this.height=SPoker.cardHeight*t}}function LoadingScene(){Laya.Sprite.call(this),this.imagesWeight=.7,this.fontsWeight=.1,this.animsWeight=.2;var e=[{url:["loading/progress.png","loading/progress$bar.png"],type:laya.net.Loader.IMAGE}];Laya.loader.load(e,laya.utils.Handler.create(this,this.loadLoadingRes))}function MainScene(){MainScene.super(this);var e=new Pokers([52,52,52,52,52,52,52,52,52],1);this.addChild(e)}NetServer.prototype.init=function(){this.socket=new laya.net.Socket,this.socket.timeout=3e3,0==this.serverIndex?(this.socket.connect("192.168.1.155",9e3),this.serverIndex=1):(this.socket.connectByUrl("ws://www.geqi99.com:9000"),this.serverIndex=0),this.socket.on(Laya.Event.OPEN,this,this.onSocketOpen),this.socket.on(Laya.Event.CLOSE,this,this.onSocketClose),this.socket.on(Laya.Event.ERROR,this,this.onSocketError),this.socket.on(Laya.Event.MESSAGE,this,this.onSocketReceiveMsg)},NetServer.prototype.onSocketOpen=function(e){this.receiveTime=(new Date).getTime(),JSExtern.log("socket open")},NetServer.prototype.onSocketClose=function(e){JSExtern.log("socket close")},NetServer.prototype.onSocketError=function(e){JSExtern.log("socket error")},NetServer.prototype.onSocketReceiveMsg=function(e){this.receiveTime=(new Date).getTime()},NetServer.prototype.sendMsg=function(e){var t=JSON.stringify(e);this.socket&&1==this.socket.connected&&this.socket.send(t)},NetServer.prototype.checkNet=function(){if((new Date).getTime()-this.receiveTime>this.receiveTimeout)return this.receiveTime=(new Date).getTime(),JSExtern.log("socket timeout, reconnect..."),this.socket&&this.socket.close(),void this.init();if(this.socket){if(1==this.socket.connected){var e={};return e.cmd=0,e.player=1e5,void this.sendMsg(e)}JSExtern.log("socket close, reconnect..."),this.socket.close(),this.init()}};var JSExtern={inherits:function(e,t){var a=function(){};a.prototype=t.prototype,e.prototype=new a,e.prototype.constructor=e},getSimpleTime:function(){var e=new Date;return e.getHours()+"-"+e.getMinutes()+" "+e.getSeconds()+"."+e.getMilliseconds()},log:function(e,t,a){var i=e;t&&(i+=t),a&&(i+=a),console.log(i)},error:function(e,t,a){var i="!!!error ";i+=e,t&&(i+=t),a&&(i+=a),console.error(i)},setStringFormat:function(){String.prototype.format=function(){if(0==arguments.length)return this;for(var e=this,t=0;t<arguments.length;++t)e=e.replace("{"+t+"}",arguments[t]);return e}}};JSExtern.inherits(HandCell,Laya.Sprite),HandCell.prototype.getID=function(){return this.id},HandCell.prototype.isSelect=function(){return this.select},HandCell.prototype.setSelect=function(e){this.select=e},HandCell.prototype.isFlag=function(){return this.flag},HandCell.prototype.setFlag=function(e){this.flag=e};var HandPanel=function(e,t,a,i,n,r,o){Laya.Sprite.call(this),this._convex=40,this._convexMoveTime=100,this._bottomConvexMoveTime=300,this._bottomCardHoldConvexTime=1e3,this._dealInterval=100,this.width=e,this.height=t,this.itemWidth=a,this.itemHeight=i,this.itemSpace=n,this.cards=r,this.compareTool=o;var s=new Laya.Sprite;this.addChild(s),this.cardNode=s;for(var l=0;l<r.length;++l)this.cardNode.addChild(r[l]),r[l].visible=!1;this.cardScale=1,this.rects=[],this.touchInArea=!1,this.canTouch=!0,this.touchBegan=new laya.maths.Point(0,0),this.touchEnd=new laya.maths.Point(0,0),this.selectCards=[],this._initTouch(),this.cards.length<25?this._setCardScale(25):this._setCardScale(this.cards.length)};JSExtern.inherits(HandPanel,Laya.Sprite),HandPanel.prototype.setSelectedCallback=function(e,t){this.caller=e,this.caller._selectedCallback=t},HandPanel.prototype.getDealCardsTime=function(){return this._dealInterval*this.cards.length},HandPanel.prototype.loadCards=function(){this.dealNum=0,Laya.timer.loop(this._dealInterval,this,this._dealCards),Laya.SoundManager.playSound(SoundsConfig.deal,0)},HandPanel.prototype.showAll=function(){this.dealNum=this.cards.length;for(var e=0;e<this.cards.length;++e)this.cards[e].visible=!0;this.freshCards()},HandPanel.prototype._dealCards=function(){if(this.dealNum==this.cards.length)return Laya.timer.clear(this,this._dealCards),void Laya.SoundManager.stopSound(SoundsConfig.deal);this.cards[this.dealNum].visible=!0,++this.dealNum,this.freshCards()},HandPanel.prototype.freshCards=function(){if(0!=this.cards.length){var e=null;if(this.compareTool)if(this.dealNum==this.cards.length)this.compareTool.sortCards(this.cards),e=this.cards;else{e=[],e.length=this.dealNum;for(var t=0;t<this.dealNum;++t)e[t]=this.cards[t];this.compareTool.sortCards(e);for(var t=0;t<this.dealNum;++t)this.cards[t]=e[t]}else e=this.cards;for(var a=this.cardScale,i=this.itemSpace*a,n=this.itemWidth*a,r=MathClient.getFirstPosOfFoldItem(this.width,i,n,e.length),t=0;t<e.length;++t)e[t].zOrder=t,e[t].scaleX=this.cards[t].scaleY=a,e[t].pos(r+t*i,0),e[t].setSelect(!1)}},HandPanel.prototype.freshMajorFlag=function(){for(var e=0;e<this.cards.length;++e){var t=this.cards[e];1==this.compareTool.isMajorByID(t.id)?t.showMajorFlag():t.hideMajorFlag()}},HandPanel.prototype.addCards=function(e){for(var t=0;t<e.length;++t)this.cardNode.addChild(e[t]);this.cards=this.cards.concat(e),this.dealNum=this.cards.length,this._setCardScale(this.cards.length),this.freshCards();for(var t=0;t<e.length;++t){var a=e[t].y-this._convex*this.cardScale,i=e[t].y;e[t].y=a,Laya.Tween.to(e[t],{y:i},this._bottomConvexMoveTime,null,null,this._bottomCardHoldConvexTime)}Laya.timer.once(this._bottomConvexMoveTime+this._bottomCardHoldConvexTime+100,this,function(){this._freshCardsRect()})},HandPanel.prototype.addCardsSimple=function(e){for(var t=0;t<e.length;++t)this.cardNode.addChild(e[t]);this.cards=this.cards.concat(e),this.dealNum=this.cards.length,this.freshCards(),this._freshCardsRect();for(var t=0;t<e.length;++t){var a=e[t].y-this._convex*this.cardScale,i=e[t].y;e[t].y=a,Laya.Tween.to(e[t],{y:i},this._bottomConvexMoveTime,null,null,this._bottomCardHoldConvexTime)}},HandPanel.prototype.getAddCardsMoveTime=function(){return this._bottomConvexMoveTime+this._bottomCardHoldConvexTime},HandPanel.prototype.removeCards=function(e){this._setCardScale(this.cards.length-e.length),this.simpleRemoveCards(e)},HandPanel.prototype.simpleRemoveCards=function(e){for(var t=this._getSelectCards(e),a=0,i=0;i<this.cards.length;++i){var n=this.cards[i];this.cards[i-a]=n,1==ContainerExtend.includeItem(t,n)&&++a}this.cards.length=this.cards.length-a;for(var i=0;i<t.length;++i)t[i].removeSelf();return this.dealNum=this.cards.length,this.freshCards(),this._freshCardsRect(),ContainerExtend.removeArray(this.selectCards,e),t},HandPanel.prototype.getSelectedIDs=function(){for(var e=[],t=0;t<this.cards.length;++t){var a=this.cards[t];1==a.isSelect()&&e.push(a.getID())}return e},HandPanel.prototype._getSelectCards=function(e){for(var t=[],a=0;a<e.length;++a){for(var i=e[a],n=!1,r=0;r<this.cards.length;++r){var o=this.cards[r];if(1==o.isSelect()&&o.getID()==i&&0==o.isFlag()){o.setFlag(!0),t.push(o),n=!0;break}}if(1!=n)for(var r=0;r<this.cards.length;++r){var o=this.cards[r];if(0==o.isFlag()&&o.getID()==i){o.setFlag(!0),t.push(o);break}}}return t},HandPanel.prototype._setCardScale=function(e){var t=MathClient.getScaleForShowAll(this.width,this.itemSpace,this.itemWidth,e);this.cardNode.pos(0,this.height-this.itemHeight*t),this.cardScale=t},HandPanel.prototype._freshCardsRect=function(){this.rects.length=this.cards.length;for(var e=0;e<this.cards.length;++e){var t=this.cards[e];if(this.rects[e]=[],1==t.isSelect()){var a=new laya.maths.Point(0,0),i=new laya.maths.Point(0,this._convex),n=new laya.maths.Point(0,0),r=new laya.maths.Point(0,0);e+1==this.cards.length?(n.x=this.itemWidth,n.y=this._convex,r.x=this.itemWidth,r.y=this.itemHeight):0==this.cards[e+1].isSelect()?(n.x=this.itemWidth,n.y=this._convex,r.x=this.itemSpace,r.y=this.itemHeight):(n.x=this.itemSpace,n.y=this._convex,r.x=this.itemSpace,r.y=this.itemHeight),this.rects[e].length=2,this.rects[e][0]=new laya.maths.Rectangle,this.rects[e][1]=new laya.maths.Rectangle,LayaExtend.getRectInWorld(t,a,n,this.rects[e][0]),LayaExtend.getRectInWorld(t,i,r,this.rects[e][1])}else{var o=new laya.maths.Point(0,0),s=new laya.maths.Point(0,0);e+1==this.cards.length?(s.x=this.itemWidth,s.y=this.itemHeight):(s.x=this.itemSpace,s.y=this.itemHeight),this.rects[e].length=1,this.rects[e][0]=new laya.maths.Rectangle,LayaExtend.getRectInWorld(t,o,s,this.rects[e][0])}}},HandPanel.prototype._initTouch=function(){function e(e){switch(e.type){case Laya.Event.MOUSE_DOWN:this.touchInArea=!0,this.touchBegan.x=e.stageX,this.touchBegan.y=e.stageY,this.touchEnd.x=e.stageX,this.touchEnd.y=e.stageY,this._showSelectFlag();break;case Laya.Event.MOUSE_MOVE:if(0==this.touchInArea)return;this.touchEnd.x=e.stageX,this.touchEnd.y=e.stageY,this._showSelectFlag();break;case Laya.Event.MOUSE_UP:if(0==this.touchInArea)return;this.touchInArea=!1,this.touchEnd.x=e.stageX,this.touchEnd.y=e.stageY,this._touchHandle();break;case Laya.Event.MOUSE_OUT:this.touchInArea=!1;for(var t=0;t<this.cards.length;++t)this.cards[t].hideSelectFlag()}}this.on(Laya.Event.MOUSE_DOWN,this,e),this.on(Laya.Event.MOUSE_MOVE,this,e),this.on(Laya.Event.MOUSE_UP,this,e),this.on(Laya.Event.MOUSE_OUT,this,e),this.size(this.width,this.height)},HandPanel.prototype.clearSelected=function(){for(var e=0;e<this.cards.length;++e)this.cards[e].setSelect(!1)},HandPanel.prototype._showSelectFlag=function(){if(0!=this.canTouch){for(var e=0;e<this.cards.length;++e)this.cards[e].hideSelectFlag();var t=MathClient.getRect(this.touchBegan,this.touchEnd),a=MathClient.getIndexRange(t,this.rects);if(0!=a.length)for(var e=0;e<a.length;++e)this.cards[a[e]].showSelectFlag()}},HandPanel.prototype._touchHandle=function(){if(0!=this.canTouch){for(var e=0;e<this.cards.length;++e)this.cards[e].hideSelectFlag();var t=MathClient.getRect(this.touchBegan,this.touchEnd),a=MathClient.getIndexRange(t,this.rects);if(0!=a.length){for(var i=a[0],n=a[a.length-1],r=!0,e=i;e<=n;++e){var o=this.cards[e];if(0==o.isSelect()){r=!1;break}}if(0==r)for(var e=i;e<=n;++e){var o=this.cards[e];0==o.isSelect()&&(o.setSelect(!0),this._convexMoveTime>0&&Laya.Tween.to(o,{y:o.y-this._convex*o.scaleX},this._convexMoveTime))}else for(var e=i;e<=n;++e){var o=this.cards[e];o.setSelect(!1),this._convexMoveTime>0&&Laya.Tween.to(o,{y:o.y+this._convex*o.scaleX},this._convexMoveTime)}var s=this.getSelectedIDs();this.selectCards=s,this.caller&&this.caller._selectedCallback(this,s),this.canTouch=!1,Laya.timer.once(this._convexMoveTime+50,this,function(){this._freshCardsRect(),this.canTouch=!0})}}},JSExtern.inherits(Poker,HandCell),Poker.createCards=function(e){for(var t=[],a=0;a<e.length;++a)t[a]=new Poker(e[a]);return t},Poker.createCardss=function(e){for(var t=[],a=0;a<e.length;++a){for(var i=[],n=0;n<e[a].length;++n)i[n]=new Poker(e[a][n]);t.push(i)}return t},Poker.createSameCards=function(e,t){for(var a=[],i=0;i<t;++i)a[i]=new Poker(e);return a},Poker.prototype.showSelectFlag=function(){if(!this.maskSprite){var e=new Laya.Sprite;e.graphics.drawRect(0,0,this.icon.width,this.icon.height,"#808080"),e.alpha=.3,e.zOrder=1,this.addChild(e),this.maskSprite=e}this.maskSprite.visible=!0},Poker.prototype.hideSelectFlag=function(){this.maskSprite&&(this.maskSprite.visible=!1)},Poker.prototype.showMajorFlag=function(){if(1!=SPoker.isJokerID(this.id)){if(!this.majorSprite){var e=new laya.ui.Image;e.skin="cards/MainCardFlag.png",e.pos(11,108),this.addChild(e),this.majorSprite=e}this.majorSprite.visible=!0}},Poker.prototype.hideMajorFlag=function(){this.majorSprite&&(this.majorSprite.visible=!1)},Poker.prototype.showBiggestFlag=function(e){if(1==e){if(!this.biggestSprite){var t=new laya.ui.Image;t.skin="cards/Big.png",t.anchorX=1,t.anchorY=0,t.pos(this.icon.width,0),this.addChild(t),this.biggestSprite=t}this.biggestSprite.visible=!0}else this.biggestSprite&&(this.biggestSprite.visible=!1)},Poker.prototype.showFirstFlag=function(){var e=new laya.ui.Image;e.skin="cards/FirstHand.png",e.anchorX=1,e.anchorY=0,e.pos(this.icon.width,0),this.addChild(e)},Poker.prototype.showFirstFlag2=function(){var e=new laya.ui.Image;e.skin="cards/FirstHand.png",e.anchorX=1,e.anchorY=0,e.pos(this.icon.width-20,0),this.addChild(e)},JSExtern.inherits(Pokers,Laya.Sprite),Pokers.prototype.removeCards=function(e){for(var t=[],a=0,i=0;i<e.length;++i)for(;a<this.cards.length;++a)if(e[i]==this.cards[a].id){this.cards[a].removeSelf(),t.push(this.cards[a]),++a;break}ContainerExtend.removeArray(this.cards,t);for(var i=0;i<this.cards.length;++i){this.cards[i].pos(i*SPoker.cardSpace,0)}},Pokers.prototype.addCards=function(e){for(var t=0;t<e.length;++t){var a=new Poker(e[t]);this.addChild(a),this.cards.push(a)}},Pokers.prototype.freshPos=function(){for(var e=0;e<this.cards.length;++e){var t=this.cards[e];t.pos(e*SPoker.cardSpace,0),t.zOrder=e}},JSExtern.inherits(Pokers2,Laya.Sprite);var SPoker={cards:[{id:0,suit:0,level:0,icon:"card_02.png",majorIcon:"card_02_major.png"},{id:1,suit:0,level:1,icon:"card_03.png",majorIcon:"card_03_major.png"},{id:2,suit:0,level:2,icon:"card_04.png",majorIcon:"card_04_major.png"},{id:3,suit:0,level:3,icon:"card_05.png",majorIcon:"card_05_major.png"},{id:4,suit:0,level:4,icon:"card_06.png",majorIcon:"card_06_major.png"},{id:5,suit:0,level:5,icon:"card_07.png",majorIcon:"card_07_major.png"},{id:6,suit:0,level:6,icon:"card_08.png",majorIcon:"card_08_major.png"},{id:7,suit:0,level:7,icon:"card_09.png",majorIcon:"card_09_major.png"},{id:8,suit:0,level:8,icon:"card_10.png",majorIcon:"card_10_major.png"},{id:9,suit:0,level:9,icon:"card_11.png",majorIcon:"card_11_major.png"},{id:10,suit:0,level:10,icon:"card_12.png",majorIcon:"card_12_major.png"},{id:11,suit:0,level:11,icon:"card_13.png",majorIcon:"card_13_major.png"},{id:12,suit:0,level:12,icon:"card_01.png",majorIcon:"card_01_major.png"},{id:13,suit:1,level:0,icon:"card_15.png",majorIcon:"card_15_major.png"},{id:14,suit:1,level:1,icon:"card_16.png",majorIcon:"card_16_major.png"},{id:15,suit:1,level:2,icon:"card_17.png",majorIcon:"card_17_major.png"},{id:16,suit:1,level:3,icon:"card_18.png",majorIcon:"card_18_major.png"},{id:17,suit:1,level:4,icon:"card_19.png",majorIcon:"card_19_major.png"},{id:18,suit:1,level:5,icon:"card_20.png",majorIcon:"card_20_major.png"},{id:19,suit:1,level:6,icon:"card_21.png",majorIcon:"card_21_major.png"},{id:20,suit:1,level:7,icon:"card_22.png",majorIcon:"card_22_major.png"},{id:21,suit:1,level:8,icon:"card_23.png",majorIcon:"card_23_major.png"},{id:22,suit:1,level:9,icon:"card_24.png",majorIcon:"card_24_major.png"},{id:23,suit:1,level:10,icon:"card_25.png",majorIcon:"card_25_major.png"},{id:24,suit:1,level:11,icon:"card_26.png",majorIcon:"card_26_major.png"},{id:25,suit:1,level:12,icon:"card_14.png",majorIcon:"card_14_major.png"},{id:26,suit:2,level:0,icon:"card_28.png",majorIcon:"card_28_major.png"},{id:27,suit:2,level:1,icon:"card_29.png",majorIcon:"card_29_major.png"},{id:28,suit:2,level:2,icon:"card_30.png",majorIcon:"card_30_major.png"},{id:29,suit:2,level:3,icon:"card_31.png",majorIcon:"card_31_major.png"},{id:30,suit:2,level:4,icon:"card_32.png",majorIcon:"card_32_major.png"},{id:31,suit:2,level:5,icon:"card_33.png",majorIcon:"card_33_major.png"},{id:32,suit:2,level:6,icon:"card_34.png",majorIcon:"card_34_major.png"},{id:33,suit:2,level:7,icon:"card_35.png",majorIcon:"card_35_major.png"},{id:34,suit:2,level:8,icon:"card_36.png",majorIcon:"card_36_major.png"},{id:35,suit:2,level:9,icon:"card_37.png",majorIcon:"card_37_major.png"},{id:36,suit:2,level:10,icon:"card_38.png",majorIcon:"card_38_major.png"},{id:37,suit:2,level:11,icon:"card_39.png",majorIcon:"card_39_major.png"},{id:38,suit:2,level:12,icon:"card_27.png",majorIcon:"card_27_major.png"},{id:39,suit:3,level:0,icon:"card_41.png",majorIcon:"card_41_major.png"},{id:40,suit:3,level:1,icon:"card_42.png",majorIcon:"card_42_major.png"},{id:41,suit:3,level:2,icon:"card_43.png",majorIcon:"card_43_major.png"},{id:42,suit:3,level:3,icon:"card_44.png",majorIcon:"card_44_major.png"},{id:43,suit:3,level:4,icon:"card_45.png",majorIcon:"card_45_major.png"},{id:44,suit:3,level:5,icon:"card_46.png",majorIcon:"card_46_major.png"},{id:45,suit:3,level:6,icon:"card_47.png",majorIcon:"card_47_major.png"},{id:46,suit:3,level:7,icon:"card_48.png",majorIcon:"card_48_major.png"},{id:47,suit:3,level:8,icon:"card_49.png",majorIcon:"card_49_major.png"},{id:48,suit:3,level:9,icon:"card_50.png",majorIcon:"card_50_major.png"},{id:49,suit:3,level:10,icon:"card_51.png",majorIcon:"card_51_major.png"},{id:50,suit:3,level:11,icon:"card_52.png",majorIcon:"card_52_major.png"},{id:51,suit:3,level:12,icon:"card_40.png",majorIcon:"card_40_major.png"},{id:52,suit:4,level:13,icon:"card_53.png",majorIcon:"card_53_major.png"},{id:53,suit:4,level:14,icon:"card_54.png",majorIcon:"card_54_major.png"}],getCards:function(e,t,a){for(var i=[],n=[],r=0;r<e;++r)for(var o=0;o<this.cards.length;++o)n.push(this.cards[o].id);for(var s=RandomExtend.getNoRepeat(n,n.length),l=Math.round((s.length-a)/t),r=0;r<t;++r){for(var c=[],h=r*l,o=h;o<h+l;++o)c.push(s[o]);i.push(c)}for(var d=[],r=s.length-a;r<s.length;++r)d.push(s[r]);return i.push(d),i},saveRes:function(){for(var e=[],t=[],a=0;a<SPoker.cards.length;++a)e.push(SPoker.root+SPoker.cards[a].icon),t.push(SPoker.root+SPoker.cards[a].majorIcon);SPoker.saveIconRes(),SPoker.saveMajorIconRes()},saveIconRes:function(){for(var e=0;e<SPoker.cards.length;++e)SPoker.cards[e].iconRes=Laya.loader.getRes(SPoker.root+SPoker.cards[e].icon)},saveMajorIconRes:function(){for(var e=0;e<SPoker.cards.length;++e)SPoker.cards[e].majorIconRes=Laya.loader.getRes(SPoker.root+SPoker.cards[e].majorIcon)},getID:function(e,t){return e+SPoker.eachSuitNum*t},isBigJokerID:function(e){return e==SPoker.bigJokerID},isLittleJokerID:function(e){return e==SPoker.littleJokerID},isJokerID:function(e){return this.isBigJokerID(e)||this.isLittleJokerID(e)},isScoreCard:function(e){var t=SPoker.cards[e];return 3==t.level||8==t.level||11==t.level}};SPoker.root="cards/",SPoker.cardWidth=122,SPoker.cardHeight=162,SPoker.majorWidth=54,SPoker.majorHeight=36,SPoker.cardSpace=50,SPoker.majorSpace=30,SPoker.suitNum=4,SPoker.eachSuitNum=13,SPoker.bigJokerID=53,SPoker.littleJokerID=52,SPoker.littleJokerLevel=13;var AnimationsConfig={root:"Animation/",breakExplode:"Break_Explode",breakPo:"Break_Po",ribbonGrey:"Ribbon_Grey",ribbonRed:"Ribbon_Red",setBottom:"SetBottom",tractor:"Tractor",victory:"Victory",timeWarning:"TimeWarning",anims:[{name:"Break_Explode",path:"Break/Explode/",begin:0,num:10},{name:"Break_Po",path:"Break/Po/",begin:0,num:2},{name:"Ribbon_Grey",path:"Ribbon/Grey/",begin:0,num:6},{name:"Ribbon_Red",path:"Ribbon/Red/",begin:0,num:8},{name:"SetBottom",path:"SetBottom/",begin:0,num:10},{name:"Tractor",path:"Tractor/",begin:0,num:5},{name:"Victory",path:"Victory/",begin:0,num:11},{name:"TimeWarning",path:"Warning/",begin:0,num:6}],init:function(){for(var e=0;e<this.anims.length;++e){var t=this.anims[e],a=this.getImages(this.root+t.path,t.begin,t.num);Laya.Animation.createFrames(a,t.name)}},getImages:function(e,t,a){for(var i=[],n=0;n<a;++n){var r=e;r+=n<=9?"0"+n+".png":n+".png",i.push(r)}return i}},FontsRes={fontRoot:"Font/",scoreNumber:"scoreNumber",clockNumber:"clock_number",names:["scoreNumber","clock_number"],files:["scoreNumber.fnt","clock_number.fnt"]},ImagesRes=[{url:["res/atlas/game.json","res/atlas/cards.json","res/atlas/GameButton.json","res/atlas/GameInfo.json","res/atlas/PlayerInfo.json","res/atlas/HeadImage.json","res/atlas/LastCards.json","res/atlas/Result.json","res/atlas/Animation/Break/Explode.json","res/atlas/Animation/Break/Po.json","res/atlas/Animation/Ribbon/Grey.json","res/atlas/Animation/Ribbon/Red.json","res/atlas/Animation/SetBottom.json","res/atlas/Animation/Tractor.json","res/atlas/Animation/Victory.json","res/atlas/Animation/Warning.json","res/atlas/Countdown.json"],type:laya.net.Loader.ATLAS},{url:["back.png"],type:laya.net.Loader.IMAGE}],LocalConfig={showLog:!1,showDlgMaskEvent:"showDlgMaskEvent",hideDlgMaskEvent:"hideDlgMaskEvent"},ScoreInfo={scoreRule:[{winDouble:0,winHalf:-1,breakHalf:-1,breakDouble:10},{winDouble:0,winHalf:5,breakHalf:15,breakDouble:20},{winDouble:0,winHalf:5,breakHalf:20,breakDouble:30},{winDouble:0,winHalf:10,breakHalf:30,breakDouble:40},{winDouble:0,winHalf:10,breakHalf:35,breakDouble:50},{winDouble:0,winHalf:15,breakHalf:45,breakDouble:60},{winDouble:0,winHalf:15,breakHalf:50,breakDouble:70},{winDouble:0,winHalf:20,breakHalf:60,breakDouble:80},{winDouble:0,winHalf:20,breakHalf:65,breakDouble:90},{winDouble:0,winHalf:25,breakHalf:75,breakDouble:100},{winDouble:0,winHalf:25,breakHalf:80,breakDouble:110},{winDouble:0,winHalf:30,breakHalf:90,breakDouble:120},{winDouble:0,winHalf:30,breakHalf:95,breakDouble:130},{winDouble:0,winHalf:35,breakHalf:105,breakDouble:140},{winDouble:0,winHalf:35,breakHalf:110,breakDouble:150},{winDouble:0,winHalf:40,breakHalf:120,breakDouble:160},{winDouble:0,winHalf:40,breakHalf:125,breakDouble:170},{winDouble:0,winHalf:45,breakHalf:130,breakDouble:180},{winDouble:0,winHalf:45,breakHalf:135,breakDouble:190},{winDouble:0,winHalf:50,breakHalf:145,breakDouble:200},{winDouble:0,winHalf:50,breakHalf:150,breakDouble:200},{winDouble:0,winHalf:55,breakHalf:155,breakDouble:200},{winDouble:0,winHalf:55,breakHalf:160,breakDouble:200},{winDouble:0,winHalf:60,breakHalf:165,breakDouble:200},{winDouble:0,winHalf:60,breakHalf:170,breakDouble:200},{winDouble:0,winHalf:65,breakHalf:175,breakDouble:200},{winDouble:0,winHalf:65,breakHalf:180,breakDouble:200},{winDouble:0,winHalf:70,breakHalf:185,breakDouble:200}],isPo:function(e,t,a){var i=Math.floor(e/5)-1,n=this.scoreRule[i],r=t+a;return!(r<e)&&(t<e&&r>=e||(t>=e&&t<n.breakHalf&&r>=n.breakHalf||t>=n.breakHalf&&t<n.breakDouble&&r>=n.breakDouble))}},ServerConfig={itemType:{stone:0,vitality:1,recordCard:2,godeye:3,nothing:99},vitalityTip:"用{0}钻石购买{1}点体力？",vitalityItems:[[1,1],[2,2],[3,3],[4,6],[5,10],[10,25]],recordCardTip:"用{0}钻石购买{1}张记牌器？",recordCardItems:[[1,1],[2,2],[3,3],[4,6],[5,10],[10,50]],godeyeTip:"用{0}钻石开启上帝之眼？",godEyeItem:5,noGoldTip:"金币不足",buySuccess:"购买成功",buyFail:"购买失败"},SoundRoot="sound/",SoundMan="sound/man/",SoundWoman="sound/woman/",SoundsConfig={on:!0,deal:SoundRoot+"deal.ogg",playcard:SoundRoot+"playcard.ogg",buyaoFirst:"buyao0.wav",buyaoLists:["buyao0.wav","buyao1.wav","buyao2.wav","buyao3.wav"],singleCard:["2.wav","3.wav","4.wav","5.wav","6.wav","7.wav","8.wav","9.wav","10.wav","11.wav","12.wav","13.wav","1.wav","14.map3","15.map3"],pairCard:["dui2.wav","dui3.wav","dui4.wav","dui5.wav","dui6.wav","dui7.wav","dui8.wav","dui9.wav","dui10.wav","dui11.wav","dui12.wav","dui13.wav","dui1.wav","dui14.map3","dui15.map3"],dani:["dani0.wav","dani1.wav"],liandui:"liandui.wav",throwcard:"throwcard.wav",kill:"kill.wav",getmain:"getmain.wav",follow:"follow.wav",win:"win.wav",lose:"lose.ogg",onesuit:["onefangkuai.wav","onemeihua.wav","onehongtao.wav","oneheitao.wav"],duisuit:["duifangkuai.wav","duimeihua.wav","duihongtao.wav","duiheitao.wav"],playSound:function(e){if(e.indexOf(".wav")<0&&e.indexOf(".ogg")<0&&e.indexOf(".wav")<0){return void 32}1==this.on&&Laya.SoundManager.playSound(e)},getGenderRoot:function(e){return 1==e?SoundMan:SoundWoman},_playBuyao:function(e,t){var a=this.getGenderRoot(t),i=a;if(1==e)i+=this.buyaoFirst;else{var n=Math.floor(Math.random()*this.buyaoLists.length);i+=this.buyaoLists[n]}this.playSound(i)},_playSingleCard:function(e,t){var a=this.getGenderRoot(t),i=a+this.singleCard[e];this.playSound(i)},_playPairCard:function(e,t){var a=this.getGenderRoot(t),i=a+this.pairCard[e];this.playSound(i)},_playDani:function(e){var t=this.getGenderRoot(e),a=Math.floor(Math.random()*this.dani.length),i=t+this.dani[a];this.playSound(i)},_playLiandui:function(e){var t=this.getGenderRoot(e),a=t+this.liandui;this.playSound(a)},_playOneSuit:function(e,t){var a=this.getGenderRoot(t),i=a+this.onesuit[e];this.playSound(i)},_playDuiSuit:function(e,t){var a=this.getGenderRoot(t),i=a+this.duisuit[e];this.playSound(i)},_playShuaipai:function(e,t){var a=this.getGenderRoot(t),i=a+this.throwcard;this.playSound(i)},_playeDiaozhu:function(e){var t=this.getGenderRoot(e),a=t+this.getmain;this.playSound(a)},_playeFollow:function(e){var t=this.getGenderRoot(e),a=t+this.follow;this.playSound(a)},_playeBile:function(e){var t=this.getGenderRoot(e),a=t+this.kill;this.playSound(a)},playSelectScoreSound:function(e){1==e.pass&&this._playBuyao(e.firstCall,e.isMan)},playCardSound:function(e){var t=e.isMan;if(1==e.isFirst){if(1==e.isMess)return void this._playShuaipai(t);1==e.isMajor?this._playeDiaozhu(t):1==e.isLiandui?this._playLiandui(t):1==e.isPair?this._playDuiSuit(e.suit,t):this._playOneSuit(e.suit,t)}else 1==e.isBigger?1==e.isBile?this._playeBile(t):this._playDani(t):this._playeFollow(t)}},TextsConfig={helpPanel:{abstract:"法新社27日报道称，根据官方数据，中国14亿人口当中还有近2亿人没有结婚。在8月28日(周一)中国版的情人节前后，很多商家瞄准单身人群的消费特征，用心推销自己的产品。如中国一家火锅餐馆，会在独自一人用餐的顾客对面放一只泰迪熊，这种服务主要瞄准相对年轻顾客。餐馆经理表示，泰迪熊会使顾客“不会感到孤单。\n         还有商家推出吐着舌头的狗狗形状的蛋糕，虽然这种蛋糕售价比一般蛋糕要贵20%，但是却占了销售的15%。有蛋糕店职员表示，“大家会买这样的蛋糕送给朋友，开一个善意的玩笑”。在一家鲜花店里，店主为单身人士提供一种包裹在玻璃里的干玫瑰。他相信会在七夕节这天热销，“单身人士也能给他们自己送花”。甚至美国的快餐连锁店汉堡王也在七夕节这天，为单身人士提供打折的特殊套餐。",base:"基本玩法",advanced:"高级教程",contact:"联系我们。。。。。"}};window.screenWidth=1280,window.screenHeight=720,document.bgColor="#552570",Laya.init(window.screenWidth,window.screenHeight,laya.webgl.WebGL),Laya.stage.alignV=Laya.Stage.ALIGN_MIDDLE,Laya.stage.alignH=Laya.Stage.ALIGN_CENTER,Laya.stage.scaleMode=Laya.Stage.SCALE_EXACTFIT,Laya.stage.screenMode=Laya.Stage.SCREEN_NONE,Laya.Stat.show(0,0),Laya.stage.frameRate="mouse","undefined"!=typeof conch&&(JSExtern.log("====>conch sOS:",conch.config.getOS()),conch.config.setSlowFrame(!0)),void 0!==Laya.Render&&(JSExtern.log("====>Laya.Render:","false","true"),JSExtern.log("===>Laya.Render isConchNode:",1==Laya.Render.isConchNode?"true":"false"),JSExtern.log("====>Laya.Render isConchApp:",1==Laya.Render.isConchApp?"true":"false"),JSExtern.log("===>Laya.Render isConchWebGL:",1==Laya.Render.isConchWebGL?"true":"false"),JSExtern.log("====>Laya.Render isWebGL:",1==Laya.Render.isWebGL?"true":"false"),JSExtern.log("====>Laya.Render is3DMode:",1==Laya.Render.is3DMode?"true":"false")),JSExtern.setStringFormat(),JSExtern.inherits(LoadingScene,Laya.Sprite),LoadingScene.prototype.loadLoadingRes=function(){var e=new laya.ui.ProgressBar("loading/progress.png");e.pos(50,300),e.width=300,e.sizeGrid="5,5,5,5",e.value=0,e.preValue=0,e.changeHandler=new Laya.Handler(this,function(e){}),this.addChild(e),this.progressBar=e,this.loadImages()},LoadingScene.prototype.loadImages=function(){function e(e){if(this.progressBar.value=this.progressBar.preValue+this.imagesWeight*e,e>=1){var t=(new Date).getTime();trace("load images end:"+t+", usetime:"+(t-this.loadImagesTiem)+"ms"),this.progressBar.preValue=this.imagesWeight,this.loadFont()}}var t=(new Date).getTime();JSExtern.log("begin load res:"+t),JSExtern.log("begin load image:"+t),this.loadTime=t,this.loadImagesTiem=t,Laya.loader.load(ImagesRes,null,Laya.Handler.create(this,e.bind(this),null,!1))},LoadingScene.prototype.loadFont=function(){function e(e,t){var a=FontsRes.names[e];t.setSpaceWidth(10),Laya.Text.registerBitmapFont(a,t);var i=FontsRes.fontRoot+FontsRes.files[e];if(JSExtern.log("load font:",e," ",i),this.progressBar.value=this.progressBar.preValue+this.fontsWeight*((e+1)/FontsRes.files.length),e+1==FontsRes.files.length){var n=(new Date).getTime();JSExtern.log("lond font end:"+n+", usetime:"+(n-this.loadFontTiem)+"ms"),this.progressBar.preValue+=this.fontsWeight,this.loadAnimas()}}var t=(new Date).getTime();JSExtern.log("begin load font:"+t),this.loadFontTiem=t;for(var a=0;a<FontsRes.files.length;++a){var i=FontsRes.fontRoot+FontsRes.files[a],n=new Laya.BitmapFont,r=a;n.loadFont(i,new Laya.Handler(this,e.bind(this),[r,n]))}},LoadingScene.prototype.loadAnimas=function(){var e=(new Date).getTime();JSExtern.log("begin load anims:"+e),AnimationsConfig.init();var t=(new Date).getTime();JSExtern.log("end load animms:"+e+",usetime:"+(t-e)+"ms"),JSExtern.log("end load res:"+e+", usetime:"+(e-this.loadTime)+"ms"),this.progressBar.preValue+=this.animsWeight,this.progressBar.value=this.progressBar.preValue;var a=new Laya.Animation;a.interval=100,a.play(0,!0,AnimationsConfig.breakExplode),a.on(Laya.Event.COMPLETE,this,function(e){e.removeSelf(),this.loadFinish()}.bind(this),[a]),a.x=400,a.y=300,this.addChild(a);var i=a.getGraphicBounds();a.pivot(i.width/2,i.height/2)},LoadingScene.prototype.loadFinish=function(){var e=new NetServer;e.init(),Laya.netServer=e,Laya.stage.scene.destroy();var t=new MainScene;Laya.stage.scene=t,Laya.stage.addChild(t)};var loadingscene=new LoadingScene;Laya.stage.scene=loadingscene,Laya.stage.addChild(loadingscene),Laya.class(MainScene,"MainScene",MainSceneUI);var ContainerExtend={removeSet:function(e,t){for(var a=0,i=0;i<e.length;++i){var n=e[i];e[i-a]=n,1==t.has(n)&&++a}e.length-=a},removeArray:function(e,t){for(var a=0;a<t.length;++a)for(var i=0;i<e.length;++i)if(t[a]==e[i]){e[i]=null;break}for(var n=0,a=0;a<e.length;++a){var r=e[a];e[a-n]=r,null==r&&++n}e.length-=n},isArrayAtleastOneItemInSet:function(e,t){for(var a=0;a<t.length;++a)if(1==e.has(t[a]))return!0;return!1},includeItem:function(e,t){for(var a=0;a<e.length;++a)if(e[a]==t)return!0;return!1},addArrayToSet:function(e,t){for(var a=0;a<e.length;++a)t.add(e[a])},isArrayIncludeArray:function(e,t){for(var a=e.slice(0),i=0;i<t.length;++i){for(var n=!1,r=0;r<a.length;++r)if(t[i]==a[r]){n=!0,a[r]=void 0;break}if(0==n)return!1}return!0}},LayaExtend={swallowAllTouch:function(e){Laya.timer.frameOnce(1,null,function(){var t=laya.events.Event,a=new Laya.Sprite;a.zOrder=-2,e.addChild(a);var i=e.globalToLocal(new laya.maths.Point(0,0));a.pos(i.x,i.y),a.size(window.screenWidth,window.screenHeight),a.on(t.CLICK,null,function(e){e.stopPropagation()})})},convertPos:function(e,t){var a=e.parent.localToGlobal(new laya.maths.Point(e.x,e.y));return t.globalToLocal(a)},changeParent:function(e,t){var a=LayaExtend.convertPos(e,t);e.removeSelf(),e.pos(a.x,a.y),t.addChild(e)},getRectInWorld:function(e,t,a,i){var n=e.localToGlobal(t),r=e.localToGlobal(a);i.x=n.x,i.y=n.y,i.width=r.x-n.x,i.height=r.y-n.y}},MathClient={getFirstPos:function(e,t,a){if(e<=0||t<=0||a<=0)return 0;var i=a*t;return e<i?0:.5*e-.5*i},getFirstPosOfFoldItem:function(e,t,a,i){if(0==i||1==i)return.5*(e-a);var n=e-a;return MathClient.getFirstPos(n,t,i-1)},getIndexRange:function(e,t){for(var a=[],i=0;i<t.length;++i)for(var n=0;n<t[i].length;++n){var r=t[i][n];if(1==e.intersects(r)){a.push(i);break}}return a},getMergeRect:function(e,t){if(0==e.length)t.x=0,t.y=0,t.width=0,t.height=0;else{for(var a=e[0][0],i=a.x,n=a.x+a.width,r=a.y,o=a.y+a.height,s=0;s<e.length;++s)for(var l=0;l<e[s].length;++l){var c=e[s][l];c.x<i&&(i=c.x),c.x+c.width>n&&(n=c.x+c.width),c.y<r&&(r=c.y),c.y+c.height>o&&(o=c.y+c.height)}t.x=i,t.y=r,t.width=n-i,t.height=o-r}},getScaleForShowAll:function(e,t,a,i){return i<=1?1:e>=t*(i-1)+a?1:e/(t*(i-1)+a)},getRect:function(e,t){var a=new laya.maths.Rectangle;return e.x<=t.x?(a.x=e.x,a.width=t.x-e.x):(a.x=t.x,a.width=e.x-t.x),e.y<=t.y?(a.y=e.y,a.height=t.y-e.y):(a.y=t.y,a.height=e.y-t.y),a}},MathExtend={getSingle:function(e){
for(var t=[],a=0;a<e.length;){if(a+1==e.length){t.push(e[a]);break}e[a]==e[a+1]?a+=2:(t.push(e[a]),++a)}return t},getPair:function(e){for(var t=[],a=0;a<e.length&&a+1!=e.length;)e[a]==e[a+1]?(t.push(e[a]),a+=2):++a;return t},getTargetIndex:function(e,t){for(var a=0;a<e.length;++a)if(e[a].id==t)return a;return-1},getShowIndex:function(e,t,a){return(MathExtend.getTargetIndex(t,a)+t.length-e)%t.length}},RandomExtend={getNoRepeat:function(e,t){if(!(0==e.length||t<=0||t>e.length)){for(var a=[],i=e.slice(0),n=e.length,r=0;r<t;++r){var o=Math.floor(Math.random()*n),s=i[o];a.push(s),i[o]=i[n-1],--n}return a}},getRandInt:function(e){return Math.floor(Math.random()*e)}};